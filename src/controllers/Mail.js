const nodemailer = require('nodemailer');
require('dotenv').config();

const sendNotification = (contact,tracking_address,subject)=>{
    var transporter = nodemailer.createTransport({
        host : 'smtp.gmail.com',
        port : 465,
        auth : {
            user : process.env.MAIL_USER,
            pass : process.env.MAIL_PASSWD
        }
    });
    
    var mailOptions = {
        from : process.env.MAIL_USER,
        to : contact,
        subject,
        //text : 'This is the text body...',
        html : `<table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; min-width: 450px;"><tbody><tr style="text-align: left;"><td><h2 color="#000000" class="sc-fBuWsC eeihxG" style="margin: 0px; font-size: 18px; color: rgb(0, 0, 0);"> Boas noticias</h2></td></tr><tr><br></tr><tr style="text-align: left;"><td><h3 color="#000000" class="sc-fBuWsC eeihxG" style="margin: 0px; font-size: 18px; color: rgb(0, 0, 0);"> Estamos chegando... </h3></td></tr><tr><br></tr><tr style="text-align: left;"><td><h3 color="#000000" class="sc-fBuWsC eeihxG" style="margin: 0px; font-size: 18px; color: rgb(0, 0, 0);"> Acompanhe em tempo real no link abaixo </h3></td></tr><tr><br></tr><tr><td> <a href="${tracking_address}">${tracking_address}</a> </td></tr>  <tr><td><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; width: 100%;"><tbody><tr><td height="30"></td></tr><tr><td color="#1c2276" direction="horizontal" height="1" class="sc-jhAzac hmXDXQ" style="width: 100%; border-bottom: 1px solid rgb(28, 34, 118); border-left: none; display: block;"></td></tr><tr><td height="30"></td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; width: 100%;"><tbody><tr style="vertical-align: middle;"><td><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial;"><tbody><tr height="25" style="vertical-align: middle;"><td width="30" style="vertical-align: middle;"><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial;"><tbody><tr><td style="vertical-align: bottom;"><span color="#1c2276" width="11" class="sc-jlyJG bbyJzT" style="display: block; background-color: rgb(28, 34, 118);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/phone-icon-2x.png" color="#1c2276" width="13" class="sc-iRbamj blSEcj" style="display: block; background-color: rgb(28, 34, 118);"></span></td></tr></tbody></table></td><td style="padding: 0px; color: rgb(0, 0, 0);"><a href="tel:+55 27 99649-0374" color="#000000" class="sc-gipzik iyhjGb" style="text-decoration: none; color: rgb(0, 0, 0); font-size: 12px;"><span>+55 27 99649-0374</span></a></td></tr><tr height="25" style="vertical-align: middle;"><td width="30" style="vertical-align: middle;"><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial;"><tbody><tr><td style="vertical-align: bottom;"><span color="#1c2276" width="11" class="sc-jlyJG bbyJzT" style="display: block; background-color: rgb(28, 34, 118);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/email-icon-2x.png" color="#1c2276" width="13" class="sc-iRbamj blSEcj" style="display: block; background-color: rgb(28, 34, 118);"></span></td></tr></tbody></table></td><td style="padding: 0px;"><a href="mailto:ams@thready.com.br" color="#000000" class="sc-gipzik iyhjGb" style="text-decoration: none; color: rgb(0, 0, 0); font-size: 12px;"><span>ams@thready.com.br</span></a></td></tr><tr height="25" style="vertical-align: middle;"><td width="30" style="vertical-align: middle;"><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial;"><tbody><tr><td style="vertical-align: bottom;"><span color="#1c2276" width="11" class="sc-jlyJG bbyJzT" style="display: block; background-color: rgb(28, 34, 118);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/link-icon-2x.png" color="#1c2276" width="13" class="sc-iRbamj blSEcj" style="display: block; background-color: rgb(28, 34, 118);"></span></td></tr></tbody></table></td><td style="padding: 0px;"><a href="//www.thready.com.br" color="#000000" class="sc-gipzik iyhjGb" style="text-decoration: none; color: rgb(0, 0, 0); font-size: 12px;"><span>www.thready.com.br</span></a></td></tr></tbody></table></td><td width="15"><div></div></td><td style="text-align: right;"><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; width: 100%;"><tbody><tr><td><img src="https://www.dropbox.com/s/jbbgzcv0c3bm7a2/logo_thready_150.png?raw=1" role="presentation" width="130" class="sc-cHGsZl bHiaRe" style="max-width: 130px; display: inline-block;"></td></tr><tr><td height="10"></td></tr><tr><td><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; display: inline-block;"><tbody><tr style="text-align: right;"><td><a href="https://twitter.com/thready_systems" color="#3e3e4a" class="sc-hzDkRC kpsoyz" style="display: inline-block; padding: 0px; background-color: rgb(62, 62, 74);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/twitter-icon-2x.png" alt="twitter" color="#3e3e4a" height="24" class="sc-bRBYWo ccSRck" style="background-color: rgb(62, 62, 74); max-width: 135px; display: block;"></a></td><td width="5"><div></div></td><td><a href="https://www.linkedin.com/in/thready/" color="#3e3e4a" class="sc-hzDkRC kpsoyz" style="display: inline-block; padding: 0px; background-color: rgb(62, 62, 74);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/linkedin-icon-2x.png" alt="linkedin" color="#3e3e4a" height="24" class="sc-bRBYWo ccSRck" style="background-color: rgb(62, 62, 74); max-width: 135px; display: block;"></a></td><td width="5"><div></div></td><td><a href="https://www.instagram.com/threadysystem/" color="#3e3e4a" class="sc-hzDkRC kpsoyz" style="display: inline-block; padding: 0px; background-color: rgb(62, 62, 74);"><img src="https://cdn2.hubspot.net/hubfs/53/tools/email-signature-generator/icons/instagram-icon-2x.png" alt="instagram" color="#3e3e4a" height="24" class="sc-bRBYWo ccSRck" style="background-color: rgb(62, 62, 74); max-width: 135px; display: block;"></a></td><td width="5"><div></div></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="sc-gPEVay eQYmiW" style="vertical-align: -webkit-baseline-middle; font-size: medium; font-family: Arial; width: 100%;"><tbody><tr><td height="30"></td></tr><tr><td color="#1c2276" direction="horizontal" height="1" class="sc-jhAzac hmXDXQ" style="width: 100%; border-bottom: 1px solid rgb(28, 34, 118); border-left: none; display: block;"></td></tr><tr><td height="30"></td></tr></tbody></table></td></tr><tr><td style="text-align: left;"><a href="https://www.hubspot.com/email-signature-generator?utm_source=create-signature" target="_blank" rel="noopener noreferrer" class="sc-gisBJw kDlVKO" style="font-size: 12px; display: block; color: rgb(0, 0, 0);">Create Your Own Free Signature</a></td></tr></tbody></table>`
    }
    
    transporter.sendMail(mailOptions,(err,info)=>{
        if(err){
            console.log(err)
        }else{
            console.log(`mail sent : ${info.response}`)
        }
    })
}

exports.sendNotification = sendNotification;